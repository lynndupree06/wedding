<p class='visible-xs visible-sm' id="notice"><%= notice %></p>

<%= link_to 'Edit', edit_group_path(@group) %> |
<%= link_to 'All Groups', groups_path %>

<h1>
  <%= @group.name %>
  <span class="label label-primary"><%= GroupsGuests.where(group_id: @group.id).count %></span>
</h1>

<br>
<div>
  <p>
    <strong>Number Attending: </strong>

    <% if @group.id == 6 %>
        <%= Party.where(rsvp_brunch: true).joins(guests: :group).where("'groups'.id = #{@group.id}").count %>
    <% elsif @group.id == 5 %>
        <%= Party.where(rsvp_dinner: true).joins(guests: :group).where("'groups'.id = #{@group.id}").count %>
    <% else %>
        <%= Party.where(rsvp: true).joins(guests: :group).where("'groups'.id = #{@group.id}").count %>
    <% end %>
  </p>
</div>
<br>

<p>
<table class="table tablesorter">
  <thead>
  <tr>
    <th>Name</th>
    <th>A/B List</th>

    <% if @group.name == 'Rehearsal Dinner' || @group.name == 'Sunday Brunch' %>
        <th>Attending?</th>
    <% else %>
        <th>RSVP?</th>
    <% end %>
  </tr>
  </thead>

  <tbody>
  <% Guest.joins(:party).joins(:group).where('groups.id = ?', @group.id).each do |guest| %>
      <tr>
        <td><%= guest.first_name %> <%= guest.last_name %><%= guest.suffix.present? ? ", #{guest.suffix}" : '' %></td>
        <td><%= guest.party.a_b_list %></td>

        <% if @group.name == 'Rehearsal Dinner' %>
            <td><%= guest.party.rsvp_dinner ? 'yes' : 'no' %></td>
        <% elsif @group.name == 'Sunday Brunch' %>
            <td><%= guest.party.rsvp_brunch ? 'yes' : 'no' %></td>
        <% else %>
            <td><%= guest.party.rsvp ? 'yes' : 'no' %></td>
        <% end %>

      </tr>
  <% end %>
  </tbody>
</table>
</p>

